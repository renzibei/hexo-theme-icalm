<% if (theme.disqusjs.enable === 'all' || (theme.disqusjs.enable === 'post' && !isPage)) { %>
    <script>
        function createDisqusJS() {
            window.dsqjs = new DisqusJS({
            shortname: '<%= theme.disqusjs.shortname %>',
            siteName: '<%= theme.disqusjs.sitename %>',
            identifier: '<%= page.path %>',
            url: '<%= page.permalink %>',
            // title: '',
            api: '<%= theme.disqusjs.api %>',
            apikey: '<%= theme.disqusjs.apikey %>',
            nocomment: '<%= theme.disqusjs.nocomment %>',
            // admin: '',
            // adminLabel: ''
        });
        }
        
    </script>

    
    <script>

        function needPolyFill() {
            if(window.fetch && window.Promise) {
                return false;
            }
            return true;
        }

        if(needPolyFill()) {
            var s1 = document.createElement('script');
            s1.src = 'https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js';
            var s2 = document.createElement('script');
            s2.src = 'https://cdn.jsdelivr.net/npm/whatwg-fetch@3.0.0/dist/fetch.umd.min.js';
            document.body.appendChild(s1);
            document.body.appendChild(s2);
        }
    </script>

    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css" media="none" onload="if(media!='all')media='all'"> -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css" as="style">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css" media="none" onload="if(media!='all')media='all'">
    <!-- <script defer src="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqus.js" onload="createDisqusJS()" disqusjs></script> -->
    <script defer src="https://cdn.jsdelivr.net/gh/sukkaw/disqusjs@60a543073734827831871cda709e14aee8afd670/dist/disqus.js" onload="createDisqusJS()" disqusjs></script>

    <!-- <script defer src="<%- url_for('js/disqus.js') %>" onload="createDisqusJS()" disqusjs></script> -->

<% } %>